direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 1.2,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=25)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=10)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=30)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=30)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="black", face="bold", size=30)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area (", cm^2,")"))))+
xlab("Treatment")+
ggtitle("Leaf area reaction norms")
stat_compare_means(comparisons = my_comparisons, label = "p.signif") # Add significance levels
p5a
p5b <- ggplot(df5b, aes(factor(TRT), phenotype, fill=TRT)) + geom_violin(alpha=0.5,color = NA) +
scale_fill_manual(values=c("#9f4c49", "#008764")) + scale_x_discrete(limits=c("LAP_SD_WW","LAP_SD_LW"), labels = c('Well-watered','Drought'), expand = c(0.1, 0.1)) +
geom_point(color= "black",size=5,
alpha =0.6,
position=position_jitter(width=0.005)) +
geom_text_repel(aes(label = name), data = data_ends,
fontface ="bold", color = "black", size = 4, box.padding = 1, force = 0.5, segment.colour="#575d5d",
nudge_x      = -0.30,
direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 1.2,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=25)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=10)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=30)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=30)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="black", face="bold", size=30)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area potential"))))+
xlab("Treatment")+
ggtitle("Reaction norms")
p5b
p5a <- ggplot(df5a, aes(factor(TRT), phenotype, fill=TRT)) + geom_violin(alpha=0.5,color = NA) +
scale_fill_manual(values=c("#9f4c49", "#008764")) + scale_x_discrete(limits=c("LA_SD_WW","LA_SD_LW"), labels = c('Well-watered','Drought'), expand = c(0.1, 0.1)) +
geom_point(color= "black",size=2,
alpha =0.6,
position=position_jitter(width=0.005)) +
geom_text_repel(aes(label = accession_name), data = data_ends,
fontface ="bold", color = "black", size = 2, box.padding = 1, force = 0.5, segment.colour="#575d5d",
nudge_x      = -0.40,
direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 0.75,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=18)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=10)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=25)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=12)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="#e79400", face="bold", size=25)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area (", cm^2,")"))))+
xlab("Treatment")+
# ggtitle("Drought")+
stat_compare_means(comparisons = my_comparisons, label = "p.signif") # Add significance levels
p5a
head(df5a)
data = read_csv("data/phenotypes.csv")
df5a <- data[c("accession_id", "accession_name", "LA_SD_WW", "LA_SD_LW")]
head(df5a)
head(df5a)
df5a<-df5a[!is.na(df5a$LA_SD_LW), ]
df5a<- df5a %>%
gather(TRT, phenotype, LA_SD_LW:LA_SD_WW)
df5a<-df5a[complete.cases(df1), ]
head(df5a)
my_comparisons <- list( c("LA_SD_WW", "LA_SD_LW") )
data_ends <- df5a %>% filter(TRT == "LA_SD_WW")
p5a <- ggplot(df5a, aes(factor(TRT), phenotype, fill=TRT)) + geom_violin(alpha=0.5,color = NA) +
scale_fill_manual(values=c("#9f4c49", "#008764")) + scale_x_discrete(limits=c("LA_SD_WW","LA_SD_LW"), labels = c('Well-watered','Drought'), expand = c(0.1, 0.1)) +
geom_point(color= "black",size=2,
alpha =0.6,
position=position_jitter(width=0.005)) +
geom_text_repel(aes(label = accession_name), data = data_ends,
fontface ="bold", color = "black", size = 2, box.padding = 1, force = 0.5, segment.colour="#575d5d",
nudge_x      = -0.40,
direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 0.75,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=18)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=10)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=25)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=12)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="#e79400", face="bold", size=25)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area (", cm^2,")"))))+
xlab("Treatment")+
# ggtitle("Drought")+
stat_compare_means(comparisons = my_comparisons, label = "p.signif") # Add significance levels
p5a
p5a <- ggplot(df5a, aes(factor(TRT), phenotype, fill=TRT)) + geom_violin(alpha=0.5,color = NA) +
scale_fill_manual(values=c("#9f4c49", "#008764")) + scale_x_discrete(limits=c("LA_SD_WW","LA_SD_LW"), labels = c('Well-watered','Drought'), expand = c(0.1, 0.1)) +
geom_point(color= "black",size=5,
alpha =0.6,
position=position_jitter(width=0.005)) +
geom_text_repel(aes(label = name), data = data_ends,
fontface ="bold", color = "black", size = 4, box.padding = 1, force = 0.5, segment.colour="#575d5d",
nudge_x      = -0.30,
direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 1.2,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=25)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=10)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=30)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=30)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="black", face="bold", size=30)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area (", cm^2,")"))))+
xlab("Treatment")+
# ggtitle("Drought")+
stat_compare_means(comparisons = my_comparisons, label = "p.signif") # Add significance levels
p5a
p5a <- ggplot(df5a, aes(factor(TRT), phenotype, fill=TRT)) + geom_violin(alpha=0.5,color = NA) +
scale_fill_manual(values=c("#9f4c49", "#008764")) + scale_x_discrete(limits=c("LA_SD_WW","LA_SD_LW"), labels = c('Well-watered','Drought'), expand = c(0.1, 0.1)) +
geom_point(color= "black",size=5,
alpha =0.6,
position=position_jitter(width=0.005)) +
geom_text_repel(aes(label = accession_name), data = data_ends,
fontface ="bold", color = "black", size = 4, box.padding = 1, force = 0.5, segment.colour="#575d5d",
nudge_x      = -0.30,
direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 1.2,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=25)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=10)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=30)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=30)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="black", face="bold", size=30)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area (", cm^2,")"))))+
xlab("Treatment")+
# ggtitle("Drought")+
stat_compare_means(comparisons = my_comparisons, label = "p.signif") # Add significance levels
p5a
#########################################################################################################
#########################################################################################################
##############################
plot_grid(p5a,p5b, labels=c("E", "F"), greedy = TRUE, ncol = 1, nrow =2, align = 'v', hjust=0, label_size=75)
png("BottomRight.png", width = 22, height = 24, units = 'in', res = 350)
plot_grid(p5a,p5b, labels=c("E", "F"), greedy = TRUE, ncol = 1, nrow =2, align = 'v', hjust=0, label_size=75)
dev.off()
BottomRight <- image_read("BottomRight.png")
#########################################################################################################
###Open dataframe with phenotypes
data = read_csv("data/phenotypes.csv")
df5a <- data[c("accession_id", "accession_name", "LA_SD_WW", "LA_SD_LW")]
head(df5a)
#df1$stability_index <- (df1$LA_SD_LW) - (df1$LA_SD_WW)
head(df5a)
df5a<-df5a[!is.na(df5a$LA_SD_LW), ]
df5a<- df5a %>%
gather(TRT, phenotype, LA_SD_LW:LA_SD_WW)
df5a<-df5a[complete.cases(df1), ]
head(df5a)
my_comparisons <- list( c("LA_SD_WW", "LA_SD_LW") )
data_ends <- df5a %>% filter(TRT == "LA_SD_WW")
p5a <- ggplot(df5a, aes(factor(TRT), phenotype, fill=TRT)) + geom_violin(alpha=0.5,color = NA) +
scale_fill_manual(values=c("#9f4c49", "#008764")) + scale_x_discrete(limits=c("LA_SD_WW","LA_SD_LW"), labels = c('Well-watered','Drought'), expand = c(0.1, 0.1)) +
geom_point(color= "black",size=5,
alpha =0.6,
position=position_jitter(width=0.005)) +
geom_text_repel(aes(label = accession_name), data = data_ends,
fontface ="bold", color = "black", size = 5, box.padding = 1, force = 0.5, segment.colour="#575d5d",
nudge_x      = -0.30,
direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 1.2,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=35)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=15)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=40)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=40)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="black", face="bold", size=50)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area (", cm^2,")"))))+
xlab("Treatment")+  ggtitle("Leaf area: reaction norms")+
# ggtitle("Drought")+
stat_compare_means(comparisons = my_comparisons, label = "p.signif") # Add significance levels
p5a
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
######Leaf area reaction norm
###Open dataframe with phenotypes
df5b = read_csv("data/phenotypic_potential.csv")
df5b <- df5b[c("accession_id", "name", "LAP_SD_WW", "LAP_SD_LW")]
head(df5b)
#df1$stability_index <- (df1$LA_SD_LW) - (df1$LAP_SD_WW)
head(df5b)
df5b<-df5b[!is.na(df5b$LAP_SD_LW), ]
df5b<- df5b %>%
gather(TRT, phenotype, LAP_SD_LW:LAP_SD_WW)
df5b<-df5b[complete.cases(df5), ]
head(df5b)
my_comparisons <- list( c("LAP_SD_WW", "LAP_SD_LW") )
data_ends <- df5b %>% filter(TRT == "LAP_SD_WW")
library(ggpubr)
p5b <- ggplot(df5b, aes(factor(TRT), phenotype, fill=TRT)) + geom_violin(alpha=0.5,color = NA) +
scale_fill_manual(values=c("#9f4c49", "#008764")) + scale_x_discrete(limits=c("LAP_SD_WW","LAP_SD_LW"), labels = c('Well-watered','Drought'), expand = c(0.1, 0.1)) +
geom_point(color= "black",size=5,
alpha =0.6,
position=position_jitter(width=0.005)) +
geom_text_repel(aes(label = name), data = data_ends,
fontface ="bold", color = "black", size = 5, box.padding = 1, force = 0.5, segment.colour="#575d5d",
nudge_x      = -0.30,
direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 1.2,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=35)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=15)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=40)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=40)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="black", face="bold", size=50)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area potential"))))+
xlab("Treatment")+
ggtitle("Leaf area potential: reaction norms")
p5b
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
plot_grid(p5a,p5b, labels=c("E", "F"), greedy = TRUE, ncol = 1, nrow =2, align = 'v', hjust=0, label_size=75)
png("BottomRight.png", width = 22, height = 24, units = 'in', res = 350)
plot_grid(p5a,p5b, labels=c("E", "F"), greedy = TRUE, ncol = 1, nrow =2, align = 'v', hjust=0, label_size=75)
dev.off()
BottomRight <- image_read("BottomRight.png")
#########################################################################################################
plot_grid(p5a,p5b, labels=c("E", "F"), greedy = TRUE, ncol = 1, nrow =2, align = 'v', hjust=0, label_size=75)
png("BottomRight.png", width = 22, height = 24, units = 'in', res = 350)
plot_grid(p5a,p5b, labels=c("E", "F"), greedy = TRUE, ncol = 1, nrow =2, align = 'v', hjust=0, label_size=75)
dev.off()
BottomRight <- image_read("BottomRight.png")
plot_grid(p3,p4, labels=c("B", "C"), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=75)
png("TopRight.png", width = 22, height = 24, units = 'in', res = 350)
plot_grid(p3,p4, labels=c("B", "C"), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=75)
dev.off()
TopRight <- image_read("TopRight.png")
M1 <- image_read("p1.jpg")
M2 <- image_read_pdf("p2b.pdf")
plot_grid(rasterGrob(M1),rasterGrob(TopRight),labels=c("A", ""),  greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0.03, label_size=40)
png("top.png", width = 22, height = 11.5, units = 'in', res = 350)
plot_grid(rasterGrob(M1),rasterGrob(TopRight),labels=c("A", ""),  greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0.03, label_size=40)
dev.off()
TOP <- image_read("top.png")
plot_grid(rasterGrob(M2),rasterGrob(BottomRight), labels=c("D", "E"), greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0, label_size=35)
png("Bottom.png", width = 22, height = 11.5, units = 'in', res = 350)
plot_grid(rasterGrob(M2),rasterGrob(BottomRight), labels=c("D", "E"), greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0, label_size=35)
dev.off()
Bottom <- image_read("Bottom.png")
plot_grid(rasterGrob(TOP),rasterGrob(Bottom), labels=c("", ""), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=40)
png("Figure 1.png", width = 20, height = 22, units = 'in', res = 350)
plot_grid(rasterGrob(TOP),rasterGrob(Bottom), labels=c("", ""), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=40)
dev.off()
plot_grid(rasterGrob(M2),rasterGrob(BottomRight), labels=c("D", ""), greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0, label_size=35)
png("Bottom.png", width = 22, height = 11.5, units = 'in', res = 350)
plot_grid(rasterGrob(M2),rasterGrob(BottomRight), labels=c("D", ""), greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0, label_size=35)
dev.off()
Bottom <- image_read("Bottom.png")
plot_grid(rasterGrob(TOP),rasterGrob(Bottom), labels=c("", ""), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=40)
png("Figure 1.png", width = 20, height = 22, units = 'in', res = 350)
plot_grid(rasterGrob(TOP),rasterGrob(Bottom), labels=c("", ""), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=40)
dev.off()
list.of.packages <- c("ggplot2", "readr","cowplot")
new.packages <- list.of.packages[!(list.of.packages %in% installed.packages()[,"Package"])]
if(length(new.packages)) install.packages(new.packages)
library(ggplot2)
library(readr)
library(cowplot)
library(magick)
library(png)
library(pdftools)
library(grid)
library(ggrepel)
library(tidyverse)
data<-read.csv("data/phenotypes.csv")
head(data)
#names(reaction)
## LA_SD_WW = Leaf area under well-watered conditions (cm2)
## FT_SD_WW = Flowering time under well-watered conditions (days)
## height_SD_WW = Bolt height under well-watered (cm)
## Yield_SD_WW = Yield under well-watered conditions (number of siliques)
######Plot1 LASDWW
p3 <- ggplot(subset(data, !is.na(LA_SD_WW))) +
geom_bar( aes(x=accession_name, y=LA_SD_WW), stat="identity", fill="#008764", alpha=0.7) +
geom_errorbar( aes(x=accession_name, ymin=LA_SD_WW-LA_SD_WW_SE, ymax=LA_SD_WW+LA_SD_WW_SE), width=0.4, colour="black", alpha=0.9, size=1.3) +
# scale_y_continuous(breaks = c(5,10,15,20), limits = c(0,300)) +
scale_y_continuous( limits = c(0,200)) +
theme_bw() +
theme(axis.line = element_line( colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(panel.background=element_rect(fill='white')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(axis.text = element_text(family = "sans", color="#666666", face="bold", size=18)) +
theme(axis.title = element_text(family = "sans", color="#666666", face="bold", size=30)) +
theme(plot.title = element_text(family = "Arial", color="#008764", face="bold", size=55)) +  theme(panel.background = element_rect(fill = 'white')) +
ggtitle("Well-watered")+
ylab(expression(bold("Leaf area"~cm^2)))+
xlab(expression(bold("Accession")))
p3
######Plot2 FTSDWW
p4 <- ggplot(subset(data, !is.na(LA_SD_LW))) +
geom_bar( aes(x=accession_name, y=LA_SD_LW), stat="identity", fill="#9f4c49", alpha=0.7) +
geom_errorbar( aes(x=accession_name, ymin=LA_SD_LW-LA_SD_LW_SE, ymax=LA_SD_LW+LA_SD_LW_SE), width=0.4, colour="black", alpha=0.9, size=1.3) +
# scale_y_continuous(breaks = c(5,10,15,20), limits = c(0,300)) +
scale_y_continuous( limits = c(0,200)) +
theme_bw() +
theme(axis.line = element_line( colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.grid.minor = element_blank(),
panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(panel.background=element_rect(fill='white')) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
theme(axis.text = element_text(family = "sans", color="#666666", face="bold", size=18)) +
theme(axis.title = element_text(family = "sans", color="#666666", face="bold", size=30)) +
theme(plot.title = element_text(family = "Arial", color="#9f4c49", face="bold", size=55)) +  theme(panel.background = element_rect(fill = 'white')) +
ggtitle("Drought")+
ylab(expression(bold("Leaf area"~cm^2)))+
xlab(expression(bold("Accession")))
p4
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
###Open dataframe with phenotypes
data = read_csv("data/phenotypes.csv")
df5a <- data[c("accession_id", "accession_name", "LA_SD_WW", "LA_SD_LW")]
head(df5a)
#df1$stability_index <- (df1$LA_SD_LW) - (df1$LA_SD_WW)
head(df5a)
df5a<-df5a[!is.na(df5a$LA_SD_LW), ]
df5a<- df5a %>%
gather(TRT, phenotype, LA_SD_LW:LA_SD_WW)
df5a<-df5a[complete.cases(df1), ]
head(df5a)
my_comparisons <- list( c("LA_SD_WW", "LA_SD_LW") )
data_ends <- df5a %>% filter(TRT == "LA_SD_WW")
p5a <- ggplot(df5a, aes(factor(TRT), phenotype, fill=TRT)) + geom_violin(alpha=0.5,color = NA) +
scale_fill_manual(values=c("#9f4c49", "#008764")) + scale_x_discrete(limits=c("LA_SD_WW","LA_SD_LW"), labels = c('Well-watered','Drought'), expand = c(0.1, 0.1)) +
geom_point(color= "black",size=5,
alpha =0.6,
position=position_jitter(width=0.005)) +
geom_text_repel(aes(label = accession_name), data = data_ends,
fontface ="bold", color = "black", size = 7, box.padding = 1, force = 0.5, segment.colour="#575d5d",
nudge_x      = -0.30,
direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 1.2,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=35)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=15)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=40)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=40)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="black", face="bold", size=50)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area (", cm^2,")"))))+
xlab("Treatment")+  ggtitle("Leaf area: reaction norms")+
# ggtitle("Drought")+
stat_compare_means(comparisons = my_comparisons, label = "p.signif") # Add significance levels
p5a
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
######Leaf area reaction norm
###Open dataframe with phenotypes
df5b = read_csv("data/phenotypic_potential.csv")
df5b <- df5b[c("accession_id", "name", "LAP_SD_WW", "LAP_SD_LW")]
head(df5b)
#df1$stability_index <- (df1$LA_SD_LW) - (df1$LAP_SD_WW)
head(df5b)
df5b<-df5b[!is.na(df5b$LAP_SD_LW), ]
df5b<- df5b %>%
gather(TRT, phenotype, LAP_SD_LW:LAP_SD_WW)
df5b<-df5b[complete.cases(df5), ]
head(df5b)
my_comparisons <- list( c("LAP_SD_WW", "LAP_SD_LW") )
data_ends <- df5b %>% filter(TRT == "LAP_SD_WW")
library(ggpubr)
p5b <- ggplot(df5b, aes(factor(TRT), phenotype, fill=TRT)) + geom_violin(alpha=0.5,color = NA) +
scale_fill_manual(values=c("#9f4c49", "#008764")) + scale_x_discrete(limits=c("LAP_SD_WW","LAP_SD_LW"), labels = c('Well-watered','Drought'), expand = c(0.1, 0.1)) +
geom_point(color= "black",size=5,
alpha =0.6,
position=position_jitter(width=0.005)) +
geom_text_repel(aes(label = name), data = data_ends,
fontface ="bold", color = "black", size = 7, box.padding = 1, force = 0.5, segment.colour="#575d5d",
nudge_x      = -0.30,
direction    = "y",
hjust        = 0,
segment.size = 0.2,max.overlaps = Inf
) +
geom_line(aes(group=accession_id), color="black",size = 1.2,
alpha = 0.7)+
theme(axis.line = element_line(size=1, colour = "black"),
panel.grid.major = element_line(size=0.05,colour = "#d3d3d3"), panel.border = element_blank(), panel.background = element_blank(), axis.ticks.length=unit(0.25,"cm")) +
theme(axis.text.x = element_text(family = "Arial", color="black", face="bold", size=35)) +
theme(axis.text.y = element_text(family = "Arial", color="black", face="bold", size=15)) +
theme(axis.title.x = element_text(family = "Arial", color="black", face="bold", size=40)) +
theme(axis.title.y = element_text(family = "Arial", color="black", face="bold", size=40)) +
theme(plot.title = element_text(hjust = 0.5, vjust = - 5, family = "Arial", color="black", face="bold", size=50)) +
theme(axis.title.x=element_blank())+
theme(plot.margin=unit(c(1,1,1,1),"cm"))+
guides(fill = FALSE) +
ylab(expression(bold(paste("Leaf area potential"))))+
xlab("Treatment")+
ggtitle("Leaf area potential: reaction norms")
p5b
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
#########################################################################################################
plot_grid(p5a,p5b, labels=c("E", "F"), greedy = TRUE, ncol = 1, nrow =2, align = 'v', hjust=0, label_size=75)
png("BottomRight.png", width = 22, height = 24, units = 'in', res = 350)
plot_grid(p5a,p5b, labels=c("E", "F"), greedy = TRUE, ncol = 1, nrow =2, align = 'v', hjust=0, label_size=75)
dev.off()
BottomRight <- image_read("BottomRight.png")
plot_grid(p3,p4, labels=c("B", "C"), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=75)
png("TopRight.png", width = 22, height = 24, units = 'in', res = 350)
plot_grid(p3,p4, labels=c("B", "C"), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=75)
dev.off()
TopRight <- image_read("TopRight.png")
M1 <- image_read("p1.jpg")
M2 <- image_read_pdf("p2b.pdf")
plot_grid(rasterGrob(M1),rasterGrob(TopRight),labels=c("A", ""),  greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0.03, label_size=40)
png("top.png", width = 22, height = 11.5, units = 'in', res = 350)
plot_grid(rasterGrob(M1),rasterGrob(TopRight),labels=c("A", ""),  greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0.03, label_size=40)
dev.off()
TOP <- image_read("top.png")
plot_grid(rasterGrob(M2),rasterGrob(BottomRight), labels=c("D", ""), greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0, label_size=35)
png("Bottom.png", width = 22, height = 11.5, units = 'in', res = 350)
plot_grid(rasterGrob(M2),rasterGrob(BottomRight), labels=c("D", ""), greedy = TRUE, ncol = 2, nrow = 1, align = 'v', hjust=0, label_size=35)
dev.off()
Bottom <- image_read("Bottom.png")
plot_grid(rasterGrob(TOP),rasterGrob(Bottom), labels=c("", ""), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=40)
png("Figure 1.png", width = 20, height = 22, units = 'in', res = 350)
plot_grid(rasterGrob(TOP),rasterGrob(Bottom), labels=c("", ""), greedy = TRUE, ncol = 1, nrow = 2, align = 'v', hjust=0, label_size=40)
dev.off()
